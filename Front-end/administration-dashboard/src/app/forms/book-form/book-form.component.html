<button class="back-button" routerLink="/dashboard/product/book">Назад</button>
<button (click)="handleDelete()" *ngIf="currentBookId" mat-raised-button  color="warn" class="delete-button" >Удалить</button>
<div *ngIf="(authors$ | async) && (publishers$ | async) && (bookTypes$ | async)
            && (ageLimits$ | async) && (genres$ | async) && (coverArts$ | async); else loading" class="form-inner">
  <h3>Форма книги</h3>
  <form (submit)="handleFormSubmit()" [formGroup]="bookForm">
    <app-file-upload [imagesControl]="bookForm.controls.album"></app-file-upload>
    <mat-form-field appearance="fill">
      <mat-label>Название</mat-label>
      <input formControlName="name" matInput placeholder="Введите название">
    </mat-form-field>
    <br>
    <mat-form-field appearance="fill">
      <mat-label>Оригинальное название</mat-label>
      <input formControlName="originalName" matInput placeholder="Введите название">
    </mat-form-field>
    <br>
    <mat-form-field appearance="fill">
      <mat-label>Автор</mat-label>
      <mat-select formControlName="authorId">
        <mat-option *ngFor="let author of authors$ | async" value="{{author.id}}">
          {{author.name}}
        </mat-option>
      </mat-select>
    </mat-form-field>
    <br>
    <mat-form-field appearance="fill">
      <mat-label>Издатель</mat-label>
      <mat-select formControlName="publisherId">
        <mat-option *ngFor="let publisher of publishers$ | async" value="{{publisher.id}}">
          {{publisher.name}}
        </mat-option>
      </mat-select>
    </mat-form-field>
    <br>
    <mat-form-field appearance="fill">
      <mat-label>Жанры</mat-label>
      <mat-select formControlName="genreIds" multiple>
        <mat-option *ngFor="let genre of genres$ | async" value="{{genre.id}}">
          {{genre.name}}
        </mat-option>
      </mat-select>
    </mat-form-field>
    <br>
    <mat-form-field appearance="fill">
      <mat-label>Описание</mat-label>
      <textarea formControlName="description" matInput></textarea>
    </mat-form-field>
    <br>
    <mat-form-field appearance="fill">
      <mat-label>Тип</mat-label>
      <mat-select formControlName="typeId">
        <mat-option *ngFor="let type of bookTypes$ | async" value="{{type.id}}">
          {{type.name}}
        </mat-option>
      </mat-select>
    </mat-form-field>
    <br>
    <mat-form-field appearance="fill">
      <mat-label>Обложка</mat-label>
      <mat-select formControlName="coverArtId">
        <mat-option *ngFor="let coverArt of coverArts$ | async" value="{{coverArt.id}}">
          {{coverArt.name}}
        </mat-option>
      </mat-select>
    </mat-form-field>
    <br>
    <mat-form-field appearance="fill">
      <mat-label>Возрастное ограничение</mat-label>
      <mat-select formControlName="ageLimitId">
        <mat-option *ngFor="let ageLimit of ageLimits$ | async" value="{{ageLimit.id}}">
          {{ageLimit.name}}
        </mat-option>
      </mat-select>
    </mat-form-field>
    <br>
    <mat-form-field  appearance="fill">
      <mat-label>Год выпуска</mat-label>
      <input formControlName="releaseYear" type="number" matInput>
    </mat-form-field>
    <br>
    <mat-form-field appearance="fill">
      <mat-label>Количество страниц</mat-label>
      <input type="number" formControlName="pageQuantity" matInput>
    </mat-form-field>
    <br>
    <mat-form-field  appearance="fill">
      <mat-label>ISBN</mat-label>
      <input formControlName="ISBN" matInput>
    </mat-form-field>
    <br>
    <mat-form-field appearance="fill">
      <mat-label>Цена</mat-label>
      <input formControlName="cost" type="number" matInput>
    </mat-form-field>
    <br>
    <mat-form-field  appearance="fill">
      <mat-label>Количество</mat-label>
      <input formControlName="quantity" type="number" matInput>
    </mat-form-field>
    <br>
    <mat-form-field  appearance="fill">
      <mat-label>Формат (ДxШxВ)</mat-label>
      <input formControlName="bookFormat" matInput>
    </mat-form-field>
    <br>
    <button [disabled]="!bookForm.valid" type="submit">Подтвердить</button>
  </form>
</div>

<ng-template #loading>
  <div class="loading-block">
    <span>Loading...</span>
  </div>
</ng-template>
